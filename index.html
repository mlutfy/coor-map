<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<title>coor_map</title>

<style type="text/css">
	    div.olControlAttribution {
        bottom:0px;
    }
</style>
<script src="http://www.openlayers.org/api/OpenLayers.js"></script>
<script type="text/javascript">

function init_coor_map(e_input){
	// if map is already displayed do nothing
	if (typeof ol_map === 'object') {
		return false
	};

	//show the div
	document.getElementById('coor_map').style.height = '350px';
	document.getElementById('coor_map').style.width = '350px';

//click handler
	OpenLayers.Control.Click = OpenLayers.Class(OpenLayers.Control, {                
	    defaultHandlerOptions: {
	        'single': true,
	        'double': false,
	        'pixelTolerance': 0,
	        'stopSingle': false,
	        'stopDouble': false
	    },

	    initialize: function(options) {
	        this.handlerOptions = OpenLayers.Util.extend(
	            {}, this.defaultHandlerOptions
	        );
	        OpenLayers.Control.prototype.initialize.apply(
	            this, arguments
	        ); 
	        this.handler = new OpenLayers.Handler.Click(
	            this, {
	                'click': this.trigger
	            }, this.handlerOptions
	        );
	    }, 

	    trigger: function(e) {// onclick event
	    	var lonlat = ol_map.getLonLatFromPixel(e.xy);
			lonlat.transform( new OpenLayers.Projection("EPSG:900913"),new OpenLayers.Projection("EPSG:4326"));
			e_input.value= lonlat.lat + "," + lonlat.lon;
			e_input.blur();

		    document.getElementById('coor_map').style.height = '0px';
			document.getElementById('coor_map').style.width  = '0px';
			
			ol_map.destroy();
			delete ol_map;
	    }
});

	//create map	
	ol_map = new OpenLayers.Map('coor_map');		
    mapnik = new OpenLayers.Layer.OSM("OpenStreetMap (Mapnik)");
    ol_map.addLayers([mapnik]);
        
    // set start point   
	var position = new OpenLayers.LonLat(-8195883.9197088,5703883.9239026)
	ol_map.setCenter(position, 10 );

	// create click
    var click = new OpenLayers.Control.Click();
    ol_map.addControl(click);
   	click.activate();
}
</script>
</head>



<body>
	Find your location: <input id="coor_map_btn" onfocus="init_coor_map(this);" /><br>
    <div id="coor_map" ></div>
</body>
</html>
